{"paragraphs":[{"title":"Paragraph insert revised","text":"%sh\n# For prevent crash with other note's execution,\n# I recommend to restart spark interpreter.\n# ?? ?? ??? ??? ???? ?? ???? ??, ?? ??? ?? spark interpreter ????? ?? ?????.\n\ncurl -X PUT http://localhost:8080/api/interpreter/setting/restart/spark","user":"anonymous","dateUpdated":"2021-07-10T23:51:42+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/sh"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n\r  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\r  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\r  0     0    0     0    0     0      0      0 --:--:--  0:00:01 --:--:--     0\r  0     0    0     0    0     0      0      0 --:--:--  0:00:02 --:--:--     0\r100  3988  100  3988    0     0   1521      0  0:00:02  0:00:02 --:--:--  1520\n{\"status\":\"OK\",\"message\":\"\",\"body\":{\"id\":\"spark\",\"name\":\"spark\",\"group\":\"spark\",\"properties\":{\"zeppelin.spark.concurrentSQL\":{\"name\":\"zeppelin.spark.concurrentSQL\",\"value\":false,\"type\":\"checkbox\"},\"zeppelin.R.knitr\":{\"name\":\"zeppelin.R.knitr\",\"value\":true,\"type\":\"checkbox\"},\"zeppelin.R.cmd\":{\"name\":\"zeppelin.R.cmd\",\"value\":\"R\",\"type\":\"string\"},\"zeppelin.R.image.width\":{\"name\":\"zeppelin.R.image.width\",\"value\":\"100%\",\"type\":\"number\"},\"zeppelin.spark.importImplicit\":{\"name\":\"zeppelin.spark.importImplicit\",\"value\":true,\"type\":\"checkbox\"},\"zeppelin.dep.additionalRemoteRepository\":{\"name\":\"zeppelin.dep.additionalRemoteRepository\",\"value\":\"spark-packages,http://dl.bintray.com/spark-packages/maven,false;\",\"type\":\"textarea\"},\"zeppelin.dep.localrepo\":{\"name\":\"zeppelin.dep.localrepo\",\"value\":\"local-repo\",\"type\":\"string\"},\"zeppelin.spark.sql.stacktrace\":{\"name\":\"zeppelin.spark.sql.stacktrace\",\"value\":false,\"type\":\"checkbox\"},\"zeppelin.spark.useHiveContext\":{\"name\":\"zeppelin.spark.useHiveContext\",\"value\":true,\"type\":\"checkbox\"},\"zeppelin.spark.printREPLOutput\":{\"name\":\"zeppelin.spark.printREPLOutput\",\"value\":true,\"type\":\"checkbox\"},\"spark.cores.max\":{\"name\":\"spark.cores.max\",\"value\":\"3\",\"type\":\"number\"},\"spark.executor.memory\":{\"name\":\"spark.executor.memory\",\"value\":\"2g\",\"type\":\"string\"},\"zeppelin.spark.sql.interpolation\":{\"name\":\"zeppelin.spark.sql.interpolation\",\"value\":false,\"type\":\"checkbox\"},\"spark.driver.memory\":{\"name\":\"spark.driver.memory\",\"value\":\"2g\",\"type\":\"textarea\"},\"spark.app.name\":{\"name\":\"spark.app.name\",\"value\":\"Zeppelin\",\"type\":\"string\"},\"zeppelin.spark.maxResult\":{\"name\":\"zeppelin.spark.maxResult\",\"value\":\"1000\",\"type\":\"number\"},\"master\":{\"name\":\"master\",\"value\":\"local[*]\",\"type\":\"string\"},\"zeppelin.pyspark.python\":{\"name\":\"zeppelin.pyspark.python\",\"value\":\"python\",\"type\":\"string\"},\"args\":{\"name\":\"args\",\"value\":\"\",\"type\":\"textarea\"},\"zeppelin.spark.enableSupportedVersionCheck\":{\"name\":\"zeppelin.spark.enableSupportedVersionCheck\",\"value\":true,\"type\":\"checkbox\"},\"zeppelin.spark.useNew\":{\"name\":\"zeppelin.spark.useNew\",\"value\":true,\"type\":\"checkbox\"},\"zeppelin.pyspark.useIPython\":{\"name\":\"zeppelin.pyspark.useIPython\",\"value\":true,\"type\":\"checkbox\"},\"zeppelin.spark.uiWebUrl\":{\"name\":\"zeppelin.spark.uiWebUrl\",\"value\":\"\",\"type\":\"string\"},\"zeppelin.R.render.options\":{\"name\":\"zeppelin.R.render.options\",\"value\":\"out.format \\u003d \\u0027html\\u0027, comment \\u003d NA, echo \\u003d FALSE, results \\u003d \\u0027asis\\u0027, message \\u003d F, warning \\u003d F, fig.retina \\u003d 2\",\"type\":\"textarea\"},\"spark.jars\":{\"name\":\"spark.jars\",\"value\":\"/zeppelin/lib/sqlite-jdbc-3.23.1.jar\",\"type\":\"textarea\"}},\"status\":\"READY\",\"interpreterGroup\":[{\"name\":\"spark\",\"class\":\"org.apache.zeppelin.spark.SparkInterpreter\",\"defaultInterpreter\":true,\"editor\":{\"language\":\"scala\",\"editOnDblClick\":false,\"completionKey\":\"TAB\",\"completionSupport\":true}},{\"name\":\"sql\",\"class\":\"org.apache.zeppelin.spark.SparkSqlInterpreter\",\"defaultInterpreter\":false,\"editor\":{\"language\":\"sql\",\"editOnDblClick\":false,\"completionKey\":\"TAB\",\"completionSupport\":true}},{\"name\":\"dep\",\"class\":\"org.apache.zeppelin.spark.DepInterpreter\",\"defaultInterpreter\":false,\"editor\":{\"language\":\"scala\",\"editOnDblClick\":false,\"completionKey\":\"TAB\",\"completionSupport\":true}},{\"name\":\"pyspark\",\"class\":\"org.apache.zeppelin.spark.PySparkInterpreter\",\"defaultInterpreter\":false,\"editor\":{\"language\":\"python\",\"editOnDblClick\":false,\"completionKey\":\"TAB\",\"completionSupport\":true}},{\"name\":\"ipyspark\",\"class\":\"org.apache.zeppelin.spark.IPySparkInterpreter\",\"defaultInterpreter\":false,\"editor\":{\"language\":\"python\",\"editOnDblClick\":false,\"completionSupport\":true}},{\"name\":\"r\",\"class\":\"org.apache.zeppelin.spark.SparkRInterpreter\",\"defaultInterpreter\":false,\"editor\":{\"language\":\"r\",\"editOnDblClick\":false,\"completionSupport\":false}}],\"dependencies\":[],\"option\":{\"remote\":true,\"port\":-1,\"perNote\":\"shared\",\"perUser\":\"shared\",\"isExistingProcess\":false,\"setPermission\":false,\"owners\":[],\"isUserImpersonate\":false}}}"}]},"apps":[],"jobName":"paragraph_1538725461884_-2081992311","id":"20181005-074421_412545955","dateCreated":"2018-10-05T07:44:21+0000","dateStarted":"2021-07-10T23:51:42+0000","dateFinished":"2021-07-10T23:51:47+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5668"},{"title":"CSV 파일 - 읽기","text":"%spark.pyspark\ncsvFile = spark.read.format(\"csv\")\\\n  .option(\"header\", \"true\")\\\n  .option(\"mode\", \"FAILFAST\")\\\n  .option(\"inferSchema\", \"true\")\\\n  .load(\"/data/flight-data/csv/2010-summary.csv\")\n","user":"anonymous","dateUpdated":"2021-07-11T00:21:50+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1538725461897_500619919","id":"20181005-074421_898708185","dateCreated":"2018-10-05T07:44:21+0000","dateStarted":"2021-07-11T00:21:50+0000","dateFinished":"2021-07-11T00:21:51+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5669","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://c1d97c9ac442:4041/jobs/job?id=15","http://c1d97c9ac442:4041/jobs/job?id=16"],"interpreterSettingId":"spark"}}},{"title":"CSV 파일 - 읽은 파일 보기","text":"%spark.pyspark\ncsvFile.show()","user":"anonymous","dateUpdated":"2021-07-11T00:21:52+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+-------------------+-----+\n|   DEST_COUNTRY_NAME|ORIGIN_COUNTRY_NAME|count|\n+--------------------+-------------------+-----+\n|       United States|            Romania|    1|\n|       United States|            Ireland|  264|\n|       United States|              India|   69|\n|               Egypt|      United States|   24|\n|   Equatorial Guinea|      United States|    1|\n|       United States|          Singapore|   25|\n|       United States|            Grenada|   54|\n|          Costa Rica|      United States|  477|\n|             Senegal|      United States|   29|\n|       United States|   Marshall Islands|   44|\n|              Guyana|      United States|   17|\n|       United States|       Sint Maarten|   53|\n|               Malta|      United States|    1|\n|             Bolivia|      United States|   46|\n|            Anguilla|      United States|   21|\n|Turks and Caicos ...|      United States|  136|\n|       United States|        Afghanistan|    2|\n|Saint Vincent and...|      United States|    1|\n|               Italy|      United States|  390|\n|       United States|             Russia|  156|\n+--------------------+-------------------+-----+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1625940264940_1085933578","id":"20210710-180424_1409958938","dateCreated":"2021-07-10T18:04:24+0000","dateStarted":"2021-07-11T00:21:53+0000","dateFinished":"2021-07-11T00:21:53+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5670","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://c1d97c9ac442:4041/jobs/job?id=17"],"interpreterSettingId":"spark"}}},{"title":"CSV 파일 - tsv 파일로 변환해 특정 저장소에 덮어 쓰기","text":"%spark.pyspark\n\n\ncsvFile.write.format(\"csv\").mode(\"overwrite\").option(\"sep\", \"\\t\")\\\n  .save(\"/tmp/my-tsv-file.tsv\")","user":"anonymous","dateUpdated":"2021-07-10T23:51:54+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"Fail to execute line 1: csvFile.write.format(\"csv\").mode(\"overwrite\").option(\"sep\", \"\\t\")\\\nTraceback (most recent call last):\n  File \"/tmp/zeppelin_pyspark-4824976187102120177.py\", line 380, in <module>\n    exec(code, _zcUserQueryNameSpace)\n  File \"<stdin>\", line 1, in <module>\nNameError: name 'csvFile' is not defined\n"}]},"apps":[],"jobName":"paragraph_1538725461910_-1814538745","id":"20181005-074421_592557019","dateCreated":"2018-10-05T07:44:21+0000","dateStarted":"2021-07-10T23:52:20+0000","dateFinished":"2021-07-10T23:52:20+0000","status":"ERROR","progressUpdateIntervalMs":500,"$$hashKey":"object:5671"},{"title":"JSON 파일 - 읽기","text":"%spark.pyspark\n\n\nspark.read.format(\"json\").option(\"mode\", \"FAILFAST\")\\\n  .option(\"inferSchema\", \"true\")\\\n  .load(\"/data/flight-data/json/2010-summary.json\").show(5)\n","user":"anonymous","dateUpdated":"2021-07-10T23:51:57+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1538725461923_885469928","id":"20181005-074421_1898377448","dateCreated":"2018-10-05T07:44:21+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5672","dateFinished":"2021-07-10T23:52:25+0000","dateStarted":"2021-07-10T23:52:20+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------------+-------------------+-----+\n|DEST_COUNTRY_NAME|ORIGIN_COUNTRY_NAME|count|\n+-----------------+-------------------+-----+\n|    United States|            Romania|    1|\n|    United States|            Ireland|  264|\n|    United States|              India|   69|\n|            Egypt|      United States|   24|\n|Equatorial Guinea|      United States|    1|\n+-----------------+-------------------+-----+\nonly showing top 5 rows\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://c1d97c9ac442:4041/jobs/job?id=0","http://c1d97c9ac442:4041/jobs/job?id=1"],"interpreterSettingId":"spark"}}},{"title":"JSON 파일 - 쓰기","text":"%spark.pyspark\n\n\ncsvFile.write.format(\"json\").mode(\"overwrite\").save(\"/tmp/my-json-file.json\")\n\n\n","user":"anonymous","dateUpdated":"2021-07-10T23:51:18+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1538725461940_-1251360885","id":"20181005-074421_394998057","dateCreated":"2018-10-05T07:44:21+0000","status":"ERROR","progressUpdateIntervalMs":500,"$$hashKey":"object:5673","dateFinished":"2021-07-10T23:51:18+0000","dateStarted":"2021-07-10T23:51:18+0000","results":{"code":"ERROR","msg":[{"type":"TEXT","data":"Fail to execute line 1: csvFile.write.format(\"json\").mode(\"overwrite\").save(\"/tmp/my-json-file.json\")\nTraceback (most recent call last):\n  File \"/tmp/zeppelin_pyspark-2815862065452927076.py\", line 380, in <module>\n    exec(code, _zcUserQueryNameSpace)\n  File \"<stdin>\", line 1, in <module>\nNameError: name 'csvFile' is not defined\n"}]}},{"title":"파케이 파일 - 읽기","text":"%spark.pyspark\n\n\nspark.read.format(\"parquet\")\\\n  .load(\"/data/flight-data/parquet/2010-summary.parquet\").show(5)\n\n\n","user":"anonymous","dateUpdated":"2021-07-10T23:51:17+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1538725461962_1708353577","id":"20181005-074421_1112648858","dateCreated":"2018-10-05T07:44:21+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5674","dateFinished":"2021-07-10T23:51:18+0000","dateStarted":"2021-07-10T23:51:17+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------------+-------------------+-----+\n|DEST_COUNTRY_NAME|ORIGIN_COUNTRY_NAME|count|\n+-----------------+-------------------+-----+\n|    United States|            Romania|    1|\n|    United States|            Ireland|  264|\n|    United States|              India|   69|\n|            Egypt|      United States|   24|\n|Equatorial Guinea|      United States|    1|\n+-----------------+-------------------+-----+\nonly showing top 5 rows\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://c1d97c9ac442:4040/jobs/job?id=2","http://c1d97c9ac442:4040/jobs/job?id=3"],"interpreterSettingId":"spark"}}},{"title":"파케이 파일 - 쓰기","text":"%spark.pyspark\n\n\ncsvFile.write.format(\"parquet\").mode(\"overwrite\")\\\n  .save(\"/tmp/my-parquet-file.parquet\")\n\n\n","user":"anonymous","dateUpdated":"2021-07-10T23:51:32+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1538725461983_-765627759","id":"20181005-074421_177188839","dateCreated":"2018-10-05T07:44:21+0000","status":"ERROR","progressUpdateIntervalMs":500,"$$hashKey":"object:5675","dateFinished":"2021-07-10T23:51:32+0000","dateStarted":"2021-07-10T23:51:32+0000","results":{"code":"ERROR","msg":[{"type":"TEXT","data":"Fail to execute line 1: csvFile.write.format(\"parquet\").mode(\"overwrite\")\\\nTraceback (most recent call last):\n  File \"/tmp/zeppelin_pyspark-2815862065452927076.py\", line 380, in <module>\n    exec(code, _zcUserQueryNameSpace)\n  File \"<stdin>\", line 1, in <module>\nNameError: name 'csvFile' is not defined\n"}]}},{"title":"ORC 파일 - 읽기","text":"%spark.pyspark\n\n\nspark.read.format(\"orc\").load(\"/data/flight-data/orc/2010-summary.orc\").show(5)\n\n\n","user":"anonymous","dateUpdated":"2021-07-10T23:54:51+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1538725462010_-1008192774","id":"20181005-074422_328192364","dateCreated":"2018-10-05T07:44:22+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5676","dateFinished":"2021-07-10T23:54:52+0000","dateStarted":"2021-07-10T23:54:52+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------------+-------------------+-----+\n|DEST_COUNTRY_NAME|ORIGIN_COUNTRY_NAME|count|\n+-----------------+-------------------+-----+\n|    United States|            Romania|    1|\n|    United States|            Ireland|  264|\n|    United States|              India|   69|\n|            Egypt|      United States|   24|\n|Equatorial Guinea|      United States|    1|\n+-----------------+-------------------+-----+\nonly showing top 5 rows\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://c1d97c9ac442:4041/jobs/job?id=2"],"interpreterSettingId":"spark"}}},{"title":"ORC 파일 - 쓰기","text":"%spark.pyspark\n\n\ncsvFile.write.format(\"orc\").mode(\"overwrite\").save(\"/tmp/my-json-file.orc\")\n\n\n","user":"anonymous","dateUpdated":"2021-07-10T23:55:07+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1538725462040_1870242836","id":"20181005-074422_538878406","dateCreated":"2018-10-05T07:44:22+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:5677"},{"title":"SQLDB - 읽기","text":"%spark.pyspark\n\n\ndriver = \"org.sqlite.JDBC\"\npath = \"/data/flight-data/jdbc/my-sqlite.db\"\nurl = \"jdbc:sqlite:\" + path\ntablename = \"flight_info\"\n\n\n","user":"anonymous","dateUpdated":"2021-07-11T00:17:03+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1538725462068_-553690609","id":"20181005-074422_1821542150","dateCreated":"2018-10-05T07:44:22+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5678","dateFinished":"2021-07-10T23:59:25+0000","dateStarted":"2021-07-10T23:59:25+0000","results":{"code":"SUCCESS","msg":[]}},{"title":"SQLDB - 읽기","text":"%spark.pyspark\n\n\ndbDataFrame = spark.read.format(\"jdbc\").option(\"url\", url)\\\n  .option(\"dbtable\", tablename).option(\"driver\",  driver).load()\n\n'''\npgDF = spark.read.format(\"jdbc\")\\\n  .option(\"driver\", \"org.postgresql.Driver\")\\\n  .option(\"url\", \"jdbc:postgresql://database_server\")\\\n  .option(\"dbtable\", \"schema.tablename\")\\\n  .option(\"user\", \"username\").option(\"password\", \"my-secret-password\").load()\n'''\n\n","user":"anonymous","dateUpdated":"2021-07-11T00:17:15+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1538725462097_474435493","id":"20181005-074422_1793277419","dateCreated":"2018-10-05T07:44:22+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5679","dateFinished":"2021-07-10T23:59:40+0000","dateStarted":"2021-07-10T23:59:39+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"'\\npgDF = spark.read.format(\"jdbc\")  .option(\"driver\", \"org.postgresql.Driver\")  .option(\"url\", \"jdbc:postgresql://database_server\")  .option(\"dbtable\", \"schema.tablename\")  .option(\"user\", \"username\").option(\"password\", \"my-secret-password\").load()\\n'\n"}]}},{"title":"SQLDB - 읽기 : 잘 동작하는지 확인","text":"%spark.pyspark\n\n\ndbDataFrame.select(\"DEST_COUNTRY_NAME\").distinct().show(5)\n\n\n","user":"anonymous","dateUpdated":"2021-07-11T00:17:23+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1538725462135_-1903060721","id":"20181005-074422_640083220","dateCreated":"2018-10-05T07:44:22+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5680","dateFinished":"2021-07-11T00:02:00+0000","dateStarted":"2021-07-11T00:02:00+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------------+\n|DEST_COUNTRY_NAME|\n+-----------------+\n|         Anguilla|\n|           Russia|\n|         Paraguay|\n|          Senegal|\n|           Sweden|\n+-----------------+\nonly showing top 5 rows\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://c1d97c9ac442:4041/jobs/job?id=4","http://c1d97c9ac442:4041/jobs/job?id=5","http://c1d97c9ac442:4041/jobs/job?id=6"],"interpreterSettingId":"spark"}}},{"title":"SQLDB - 읽기 : DF 생성 전 자체 데이터 필터링하도록 쿼리 지정 가능","text":"%spark.pyspark\n\n\npushdownQuery = \"\"\"(SELECT DISTINCT(DEST_COUNTRY_NAME) FROM flight_info)\n  AS flight_info\"\"\"\ndbDataFrame = spark.read.format(\"jdbc\")\\\n  .option(\"url\", url).option(\"dbtable\", pushdownQuery).option(\"driver\",  driver)\\\n  .load()\n\n\n","user":"anonymous","dateUpdated":"2021-07-11T00:17:27+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1538725462169_-1179555350","id":"20181005-074422_1689929632","dateCreated":"2018-10-05T07:44:22+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5681","dateFinished":"2021-07-11T00:02:22+0000","dateStarted":"2021-07-11T00:02:22+0000","results":{"code":"SUCCESS","msg":[]}},{"title":"SQLDB - 병렬로 읽기 : 한 번에 읽어오는 파티션 수를 10개로 제한하는 방법 ( 과부하 방지 위함)","text":"%spark.pyspark\n\n\ndbDataFrame = spark.read.format(\"jdbc\")\\\n  .option(\"url\", url).option(\"dbtable\", tablename).option(\"driver\",  driver)\\\n  .option(\"numPartitions\", 10).load()\n\n\n","user":"anonymous","dateUpdated":"2021-07-11T00:17:32+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1538725462201_1275519498","id":"20181005-074422_1780715310","dateCreated":"2018-10-05T07:44:22+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:5682"},{"text":"%spark.pyspark\ndbDataFrame.show()","user":"anonymous","dateUpdated":"2021-07-11T00:17:48+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1625961982939_282591007","id":"20210711-000622_1140798265","dateCreated":"2021-07-11T00:06:22+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:8255","dateFinished":"2021-07-11T00:06:32+0000","dateStarted":"2021-07-11T00:06:32+0000","title":"SQLDB - 조건주어 읽기 : 필터링 하지 않고, 특정 파티션 위치 제어해 최적화하는 방법. (필터링 전)","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+\n|   DEST_COUNTRY_NAME|\n+--------------------+\n|       United States|\n|               Egypt|\n|   Equatorial Guinea|\n|          Costa Rica|\n|             Senegal|\n|              Guyana|\n|               Malta|\n|             Bolivia|\n|            Anguilla|\n|Turks and Caicos ...|\n|Saint Vincent and...|\n|               Italy|\n|            Pakistan|\n|             Iceland|\n|    Marshall Islands|\n|          Luxembourg|\n|            Honduras|\n|         The Bahamas|\n|         El Salvador|\n|               Samoa|\n+--------------------+\nonly showing top 20 rows\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://c1d97c9ac442:4041/jobs/job?id=9"],"interpreterSettingId":"spark"}}},{"title":"SQLDB - 조건주어 읽기 : 필터링 하지 않고, 특정 파티션 위치 제어해 최적화하는 방법. (필터링 후)","text":"%spark.pyspark\n\n\nprops = {\"driver\":\"org.sqlite.JDBC\"}\npredicates = [\n  \"DEST_COUNTRY_NAME = 'Sweden' OR ORIGIN_COUNTRY_NAME = 'Sweden'\",\n  \"DEST_COUNTRY_NAME = 'Anguilla' OR ORIGIN_COUNTRY_NAME = 'Anguilla'\"]\nspark.read.jdbc(url, tablename, predicates=predicates, properties=props).show()\nspark.read.jdbc(url,tablename,predicates=predicates,properties=props)\\\n  .rdd.getNumPartitions() # 2\n\n\n","user":"anonymous","dateUpdated":"2021-07-11T00:17:56+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1538725462234_-491835648","id":"20181005-074422_1164283386","dateCreated":"2018-10-05T07:44:22+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5683","dateFinished":"2021-07-11T00:05:58+0000","dateStarted":"2021-07-11T00:05:58+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------------+-------------------+-----+\n|DEST_COUNTRY_NAME|ORIGIN_COUNTRY_NAME|count|\n+-----------------+-------------------+-----+\n|           Sweden|      United States|   65|\n|    United States|             Sweden|   73|\n|         Anguilla|      United States|   21|\n|    United States|           Anguilla|   20|\n+-----------------+-------------------+-----+\n\n2\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://c1d97c9ac442:4041/jobs/job?id=7","http://c1d97c9ac442:4041/jobs/job?id=8"],"interpreterSettingId":"spark"}}},{"title":"SQLDB - 조건주어 읽기 : 잘못된 예시. 연관성 없는 조건절은 많은 중복을 야기함.","text":"%spark.pyspark\n\n\nprops = {\"driver\":\"org.sqlite.JDBC\"}\npredicates = [\n  \"DEST_COUNTRY_NAME != 'Sweden' OR ORIGIN_COUNTRY_NAME != 'Sweden'\",\n  \"DEST_COUNTRY_NAME != 'Anguilla' OR ORIGIN_COUNTRY_NAME != 'Anguilla'\"]\nspark.read.jdbc(url, tablename, predicates=predicates, properties=props).show()\n\nspark.read.jdbc(url, tablename, predicates=predicates, properties=props).count()\n","user":"anonymous","dateUpdated":"2021-07-11T00:18:17+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1538725462274_512606371","id":"20181005-074422_577674461","dateCreated":"2018-10-05T07:44:22+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5684","dateFinished":"2021-07-11T00:10:37+0000","dateStarted":"2021-07-11T00:10:37+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+-------------------+-----+\n|   DEST_COUNTRY_NAME|ORIGIN_COUNTRY_NAME|count|\n+--------------------+-------------------+-----+\n|       United States|            Romania|    1|\n|       United States|            Ireland|  264|\n|       United States|              India|   69|\n|               Egypt|      United States|   24|\n|   Equatorial Guinea|      United States|    1|\n|       United States|          Singapore|   25|\n|       United States|            Grenada|   54|\n|          Costa Rica|      United States|  477|\n|             Senegal|      United States|   29|\n|       United States|   Marshall Islands|   44|\n|              Guyana|      United States|   17|\n|       United States|       Sint Maarten|   53|\n|               Malta|      United States|    1|\n|             Bolivia|      United States|   46|\n|            Anguilla|      United States|   21|\n|Turks and Caicos ...|      United States|  136|\n|       United States|        Afghanistan|    2|\n|Saint Vincent and...|      United States|    1|\n|               Italy|      United States|  390|\n|       United States|             Russia|  156|\n+--------------------+-------------------+-----+\nonly showing top 20 rows\n\n510\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://c1d97c9ac442:4041/jobs/job?id=12","http://c1d97c9ac442:4041/jobs/job?id=13"],"interpreterSettingId":"spark"}}},{"title":"슬라이딩 윈도우 기반의 파티셔닝 : 조건 설정","text":"%spark.pyspark\n\n\ncolName = \"count\"\nlowerBound = 0L\nupperBound = 348113L # DB의 데이터 최대 개수\nnumPartitions = 10 # 전체 파티션 수 = 병렬처리 수준\n\n\n","user":"anonymous","dateUpdated":"2021-07-11T00:13:31+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1538725462313_-115375793","id":"20181005-074422_1151977768","dateCreated":"2018-10-05T07:44:22+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5685","dateFinished":"2021-07-11T00:13:20+0000","dateStarted":"2021-07-11T00:13:20+0000","results":{"code":"SUCCESS","msg":[]}},{"title":"슬라이딩 윈도우 기반의 파티셔닝 ","text":"%spark.pyspark\n\n\nspark.read.jdbc(url, tablename, column=colName, properties=props,\n                lowerBound=lowerBound, upperBound=upperBound,\n                numPartitions=numPartitions).count() # 255\n\n\n","user":"anonymous","dateUpdated":"2021-07-11T00:13:41+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1538725462359_1072020861","id":"20181005-074422_1212382746","dateCreated":"2018-10-05T07:44:22+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5686","dateFinished":"2021-07-11T00:13:22+0000","dateStarted":"2021-07-11T00:13:22+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"255\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://c1d97c9ac442:4041/jobs/job?id=14"],"interpreterSettingId":"spark"}}},{"title":" SQLDB - 쓰기 : 데이터 저장","text":"%spark.pyspark\n\n\nnewPath = \"jdbc:sqlite://tmp/my-sqlite.db\"\ncsvFile.write.jdbc(newPath, tablename, mode=\"overwrite\", properties=props)\n\n\n","user":"anonymous","dateUpdated":"2021-07-11T00:22:45+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1538725462392_170585116","id":"20181005-074422_805698255","dateCreated":"2018-10-05T07:44:22+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5687","dateFinished":"2021-07-11T00:22:01+0000","dateStarted":"2021-07-11T00:22:01+0000","results":{"code":"SUCCESS","msg":[]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://c1d97c9ac442:4041/jobs/job?id=18"],"interpreterSettingId":"spark"}}},{"title":"SQLDB - 쓰기 : 데이터 추가 : 아래 덧붙인다는 의미. 실행할수록 아래 레코드 수는 증가.","text":"%spark.pyspark\n\n\ncsvFile.write.jdbc(newPath, tablename, mode=\"append\", properties=props)\n\n\n","user":"anonymous","dateUpdated":"2021-07-11T00:23:56+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1538725462480_876018183","id":"20181005-074422_140769069","dateCreated":"2018-10-05T07:44:22+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5689","dateFinished":"2021-07-11T00:23:34+0000","dateStarted":"2021-07-11T00:23:34+0000","results":{"code":"SUCCESS","msg":[]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://c1d97c9ac442:4041/jobs/job?id=21"],"interpreterSettingId":"spark"}}},{"title":"SQLDB - 쓰기 : 증가한 레코드 수 확인","text":"%spark.pyspark\n\n\nspark.read.jdbc(newPath, tablename, properties=props).count() # 765\n\n\n","user":"anonymous","dateUpdated":"2021-07-11T00:23:36+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1538725462531_-151836545","id":"20181005-074422_644359394","dateCreated":"2018-10-05T07:44:22+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5690","dateFinished":"2021-07-11T00:23:36+0000","dateStarted":"2021-07-11T00:23:36+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"765\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://c1d97c9ac442:4041/jobs/job?id=22"],"interpreterSettingId":"spark"}}},{"text":"%spark.pyspark\n\nspark.read.textFile(\"/data/flight-data/csv/2010-summary.csv\").selectExpr(\"split(value, ',') as rows\").show()","user":"anonymous","dateUpdated":"2021-07-11T00:29:05+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1625963071414_-283156529","id":"20210711-002431_460909272","dateCreated":"2021-07-11T00:24:31+0000","status":"ERROR","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:9031","dateFinished":"2021-07-11T00:28:51+0000","dateStarted":"2021-07-11T00:28:51+0000","title":"텍스트 파일 - 읽기 (에러)","results":{"code":"ERROR","msg":[{"type":"TEXT","data":"Fail to execute line 1: spark.read.textFile(\"/data/flight-data/csv/2010-summary.csv\").selectExpr(\"split(value, ',') as rows\")\nTraceback (most recent call last):\n  File \"/tmp/zeppelin_pyspark-4824976187102120177.py\", line 380, in <module>\n    exec(code, _zcUserQueryNameSpace)\n  File \"<stdin>\", line 1, in <module>\nAttributeError: 'DataFrameReader' object has no attribute 'textFile'\n"}]}},{"title":"텍스트 파일 - 쓰기 : 컬럼이 하나여야 함.","text":"%spark.pyspark\n\n\n\ncsvFile.limit(10).select(\"DEST_COUNTRY_NAME\", \"count\")\\\n  .write.partitionBy(\"count\").text(\"/tmp/five-csv-files2py.csv\")\n\n\n","user":"anonymous","dateUpdated":"2021-07-11T00:29:11+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1538725462579_385069604","id":"20181005-074422_1823320807","dateCreated":"2018-10-05T07:44:22+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5691","dateFinished":"2021-07-11T00:26:04+0000","dateStarted":"2021-07-11T00:26:03+0000","results":{"code":"SUCCESS","msg":[]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://c1d97c9ac442:4041/jobs/job?id=23"],"interpreterSettingId":"spark"}}}],"name":"Spark-The-Definitive-Guide-Python/Structured_APIs-Chapter_9_Data_Sources.py","id":"2DRDAF9B1","noteParams":{},"noteForms":{},"angularObjects":{"sh:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}