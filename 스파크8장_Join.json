{"paragraphs":[{"title":"Paragraph insert revised","text":"%sh\n# For prevent crash with other note's execution,\n# I recommend to restart spark interpreter.\n# ?? ?? ??? ??? ???? ?? ???? ??, ?? ??? ?? spark interpreter ????? ?? ?????.\n\ncurl -X PUT http://localhost:8080/api/interpreter/setting/restart/spark","user":"anonymous","dateUpdated":"2021-07-10T15:01:41+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/sh"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n\r  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\r100  3988  100  3988    0     0  84706      {0\" s-t-a:t-u-s:\"-:-\" O-K-\":,-\"-m:e-s-s a-g-e:\"-:-\":\"-,-\" b8o6d6y9\"5:\n{\"id\":\"spark\",\"name\":\"spark\",\"group\":\"spark\",\"properties\":{\"zeppelin.spark.concurrentSQL\":{\"name\":\"zeppelin.spark.concurrentSQL\",\"value\":false,\"type\":\"checkbox\"},\"zeppelin.R.knitr\":{\"name\":\"zeppelin.R.knitr\",\"value\":true,\"type\":\"checkbox\"},\"zeppelin.R.cmd\":{\"name\":\"zeppelin.R.cmd\",\"value\":\"R\",\"type\":\"string\"},\"zeppelin.R.image.width\":{\"name\":\"zeppelin.R.image.width\",\"value\":\"100%\",\"type\":\"number\"},\"zeppelin.spark.importImplicit\":{\"name\":\"zeppelin.spark.importImplicit\",\"value\":true,\"type\":\"checkbox\"},\"zeppelin.dep.additionalRemoteRepository\":{\"name\":\"zeppelin.dep.additionalRemoteRepository\",\"value\":\"spark-packages,http://dl.bintray.com/spark-packages/maven,false;\",\"type\":\"textarea\"},\"zeppelin.dep.localrepo\":{\"name\":\"zeppelin.dep.localrepo\",\"value\":\"local-repo\",\"type\":\"string\"},\"zeppelin.spark.sql.stacktrace\":{\"name\":\"zeppelin.spark.sql.stacktrace\",\"value\":false,\"type\":\"checkbox\"},\"zeppelin.spark.useHiveContext\":{\"name\":\"zeppelin.spark.useHiveContext\",\"value\":true,\"type\":\"checkbox\"},\"zeppelin.spark.printREPLOutput\":{\"name\":\"zeppelin.spark.printREPLOutput\",\"value\":true,\"type\":\"checkbox\"},\"spark.cores.max\":{\"name\":\"spark.cores.max\",\"value\":\"3\",\"type\":\"number\"},\"spark.executor.memory\":{\"name\":\"spark.executor.memory\",\"value\":\"2g\",\"type\":\"string\"},\"zeppelin.spark.sql.interpolation\":{\"name\":\"zeppelin.spark.sql.interpolation\",\"value\":false,\"type\":\"checkbox\"},\"spark.driver.memory\":{\"name\":\"spark.driver.memory\",\"value\":\"2g\",\"type\":\"textarea\"},\"spark.app.name\":{\"name\":\"spark.app.name\",\"value\":\"Zeppelin\",\"type\":\"string\"},\"zeppelin.spark.maxResult\":{\"name\":\"zeppelin.spark.maxResult\",\"value\":\"1000\",\"type\":\"number\"},\"master\":{\"name\":\"master\",\"value\":\"local[*]\",\"type\":\"string\"},\"zeppelin.pyspark.python\":{\"name\":\"zeppelin.pyspark.python\",\"value\":\"python\",\"type\":\"string\"},\"args\":{\"name\":\"args\",\"value\":\"\",\"type\":\"textarea\"},\"zeppelin.spark.enableSupportedVersionCheck\":{\"name\":\"zeppelin.spark.enableSupportedVersionCheck\",\"value\":true,\"type\":\"checkbox\"},\"zeppelin.spark.useNew\":{\"name\":\"zeppelin.spark.useNew\",\"value\":true,\"type\":\"checkbox\"},\"zeppelin.pyspark.useIPython\":{\"name\":\"zeppelin.pyspark.useIPython\",\"value\":true,\"type\":\"checkbox\"},\"zeppelin.spark.uiWebUrl\":{\"name\":\"zeppelin.spark.uiWebUrl\",\"value\":\"\",\"type\":\"string\"},\"zeppelin.R.render.options\":{\"name\":\"zeppelin.R.render.options\",\"value\":\"out.format \\u003d \\u0027html\\u0027, comment \\u003d NA, echo \\u003d FALSE, results \\u003d \\u0027asis\\u0027, message \\u003d F, warning \\u003d F, fig.retina \\u003d 2\",\"type\":\"textarea\"},\"spark.jars\":{\"name\":\"spark.jars\",\"value\":\"/zeppelin/lib/sqlite-jdbc-3.23.1.jar\",\"type\":\"textarea\"}},\"status\":\"READY\",\"interpreterGroup\":[{\"name\":\"spark\",\"class\":\"org.apache.zeppelin.spark.SparkInterpreter\",\"defaultInterpreter\":true,\"editor\":{\"language\":\"scala\",\"editOnDblClick\":false,\"completionKey\":\"TAB\",\"completionSupport\":true}},{\"name\":\"sql\",\"class\":\"org.apache.zeppelin.spark.SparkSqlInterpreter\",\"defaultInterpreter\":false,\"editor\":{\"language\":\"sql\",\"editOnDblClick\":false,\"completionKey\":\"TAB\",\"completionSupport\":true}},{\"name\":\"dep\",\"class\":\"org.apache.zeppelin.spark.DepInterpreter\",\"defaultInterpreter\":false,\"editor\":{\"language\":\"scala\",\"editOnDblClick\":false,\"completionKey\":\"TAB\",\"completionSupport\":true}},{\"name\":\"pyspark\",\"class\":\"org.apache.zeppelin.spark.PySparkInterpreter\",\"defaultInterpreter\":false,\"editor\":{\"language\":\"python\",\"editOnDblClick\":false,\"completionKey\":\"TAB\",\"completionSupport\":true}},{\"name\":\"ipyspark\",\"class\":\"org.apache.zeppelin.spark.IPySparkInterpreter\",\"defaultInterpreter\":false,\"editor\":{\"language\":\"python\",\"editOnDblClick\":false,\"completionSupport\":true}},{\"name\":\"r\",\"class\":\"org.apache.zeppelin.spark.SparkRInterpreter\",\"defaultInterpreter\":false,\"editor\":{\"language\":\"r\",\"editOnDblClick\":false,\"completionSupport\":false}}],\"dependencies\":[],\"option\":{\"remote\":true,\"port\":-1,\"perNote\":\"shared\",\"perUser\":\"shared\",\"isExistingProcess\":false,\"setPermission\":false,\"owners\":[],\"isUserImpersonate\":false}}}"}]},"apps":[],"jobName":"paragraph_1538725461646_289054533","id":"20181005-074421_957720595","dateCreated":"2018-10-05T07:44:21+0000","dateStarted":"2021-07-10T15:01:41+0000","dateFinished":"2021-07-10T15:01:43+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:6409"},{"title":"Join 할 3개의 데이터셋 생성","text":"%spark.pyspark\nperson = spark.createDataFrame([\n    (0, \"Bill Chambers\", 0, [100]),\n    (1, \"Matei Zaharia\", 1, [500, 250, 100]),\n    (2, \"Michael Armbrust\", 1, [250, 100])])\\\n  .toDF(\"id\", \"name\", \"graduate_program\", \"spark_status\")\n\ngraduateProgram = spark.createDataFrame([\n    (0, \"Masters\", \"School of Information\", \"UC Berkeley\"),\n    (2, \"Masters\", \"EECS\", \"UC Berkeley\"),\n    (1, \"Ph.D.\", \"EECS\", \"UC Berkeley\")])\\\n  .toDF(\"id\", \"degree\", \"department\", \"school\")\n\nsparkStatus = spark.createDataFrame([\n    (500, \"Vice President\"),\n    (250, \"PMC Member\"),\n    (100, \"Contributor\")])\\\n  .toDF(\"id\", \"status\")\n","user":"anonymous","dateUpdated":"2021-07-10T15:51:13+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1538725461656_902193078","id":"20181005-074421_1477062722","dateCreated":"2018-10-05T07:44:21+0000","dateStarted":"2021-07-10T15:51:14+0000","dateFinished":"2021-07-10T15:51:15+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:6410"},{"title":"예시 데이터셋(person) 살펴보기","text":"%spark.pyspark\n# person 살펴보기\nperson.head(3)","user":"anonymous","dateUpdated":"2021-07-10T15:51:18+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[Row(id=0, name=u'Bill Chambers', graduate_program=0, spark_status=[100]), Row(id=1, name=u'Matei Zaharia', graduate_program=1, spark_status=[500, 250, 100]), Row(id=2, name=u'Michael Armbrust', graduate_program=1, spark_status=[250, 100])]\n"}]},"apps":[],"jobName":"paragraph_1625930835359_679567501","id":"20210710-152715_252593831","dateCreated":"2021-07-10T15:27:15+0000","dateStarted":"2021-07-10T15:51:18+0000","dateFinished":"2021-07-10T15:51:21+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:6411"},{"text":"%spark.pyspark\nperson.show()\ngraduateProgram.show()\nsparkStatus.show()","user":"anonymous","dateUpdated":"2021-07-10T15:36:21+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+----------------+----------------+---------------+\n| id|            name|graduate_program|   spark_status|\n+---+----------------+----------------+---------------+\n|  0|   Bill Chambers|               0|          [100]|\n|  1|   Matei Zaharia|               1|[500, 250, 100]|\n|  2|Michael Armbrust|               1|     [250, 100]|\n+---+----------------+----------------+---------------+\n\n+---+-------+--------------------+-----------+\n| id| degree|          department|     school|\n+---+-------+--------------------+-----------+\n|  0|Masters|School of Informa...|UC Berkeley|\n|  2|Masters|                EECS|UC Berkeley|\n|  1|  Ph.D.|                EECS|UC Berkeley|\n+---+-------+--------------------+-----------+\n\n+---+--------------+\n| id|        status|\n+---+--------------+\n|500|Vice President|\n|250|    PMC Member|\n|100|   Contributor|\n+---+--------------+\n\n"}]},"apps":[],"jobName":"paragraph_1625931356403_-22643205","id":"20210710-153556_1756656001","dateCreated":"2021-07-10T15:35:56+0000","dateStarted":"2021-07-10T15:36:21+0000","dateFinished":"2021-07-10T15:36:22+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:6412"},{"title":"1. inner join 표현식: person - graduate_program과 graduateProgram - id","text":"%spark.pyspark\n\n\njoinExpression = person[\"graduate_program\"] == graduateProgram['id']\njoinExpression","user":"anonymous","dateUpdated":"2021-07-10T15:55:18+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Column<(graduate_program = id)>\n"}]},"apps":[],"jobName":"paragraph_1538725461668_1731818534","id":"20181005-074421_173336839","dateCreated":"2018-10-05T07:44:21+0000","dateStarted":"2021-07-10T15:55:18+0000","dateFinished":"2021-07-10T15:55:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:6413"},{"title":"Inner Join 예시 (ver1-데이터셋 자체에서 실행하는 방법)","text":"%spark.pyspark\n\ninner_join = person.join(graduateProgram, person.graduate_program == graduateProgram.id)\ninner_join.show()","user":"anonymous","dateUpdated":"2021-07-10T15:57:03+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+----------------+----------------+---------------+---+-------+--------------------+-----------+\n| id|            name|graduate_program|   spark_status| id| degree|          department|     school|\n+---+----------------+----------------+---------------+---+-------+--------------------+-----------+\n|  0|   Bill Chambers|               0|          [100]|  0|Masters|School of Informa...|UC Berkeley|\n|  1|   Matei Zaharia|               1|[500, 250, 100]|  1|  Ph.D.|                EECS|UC Berkeley|\n|  2|Michael Armbrust|               1|     [250, 100]|  1|  Ph.D.|                EECS|UC Berkeley|\n+---+----------------+----------------+---------------+---+-------+--------------------+-----------+\n\n"}]},"apps":[],"jobName":"paragraph_1625931229169_-40651135","id":"20210710-153349_303452154","dateCreated":"2021-07-10T15:33:49+0000","dateStarted":"2021-07-10T15:44:00+0000","dateFinished":"2021-07-10T15:44:03+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:6414"},{"title":"Python으로 만든 데이터셋을 ver2,ver3 방법으로 join하기 위해, 테이블로 등록","text":"%spark.pyspark\n\nperson.createOrReplaceTempView(\"person\")\ngraduateProgram.createOrReplaceTempView(\"graduateProgram\")\nsparkStatus.createOrReplaceTempView(\"sparkStatus\")","user":"anonymous","dateUpdated":"2021-07-10T15:57:43+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1625931921324_-1797227780","id":"20210710-154521_1314289492","dateCreated":"2021-07-10T15:45:21+0000","dateStarted":"2021-07-10T15:53:51+0000","dateFinished":"2021-07-10T15:53:51+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:6415"},{"title":"Inner Join 예시 (ver 2)","text":"%spark.pyspark\n\n# join 타입은 default가 inner 이므로 작성하지 않으면, inner join 자동 실행\n\njoinType = \"inner\"\nperson.join(graduateProgram, joinExpression, joinType).show()","user":"anonymous","dateUpdated":"2021-07-10T16:00:33+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+----------------+----------------+---------------+---+-------+--------------------+-----------+\n| id|            name|graduate_program|   spark_status| id| degree|          department|     school|\n+---+----------------+----------------+---------------+---+-------+--------------------+-----------+\n|  0|   Bill Chambers|               0|          [100]|  0|Masters|School of Informa...|UC Berkeley|\n|  1|   Matei Zaharia|               1|[500, 250, 100]|  1|  Ph.D.|                EECS|UC Berkeley|\n|  2|Michael Armbrust|               1|     [250, 100]|  1|  Ph.D.|                EECS|UC Berkeley|\n+---+----------------+----------------+---------------+---+-------+--------------------+-----------+\n\n"}]},"apps":[],"jobName":"paragraph_1625932478283_1157076867","id":"20210710-155438_248078934","dateCreated":"2021-07-10T15:54:38+0000","dateStarted":"2021-07-10T16:00:33+0000","dateFinished":"2021-07-10T16:00:34+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:6416"},{"title":"Inner Join 예시 (ver 3)","text":"%sql\nSELECT * FROM person \nJOIN graduateProgram\nON person.graduate_program = graduateProgram.id\n","user":"anonymous","dateUpdated":"2021-07-10T15:57:19+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"id":"string","name":"string","graduate_program":"string","spark_status":"string","degree":"string","department":"string","school":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"id\tname\tgraduate_program\tspark_status\tid\tdegree\tdepartment\tschool\n0\tBill Chambers\t0\tWrappedArray(100)\t0\tMasters\tSchool of Information\tUC Berkeley\n1\tMatei Zaharia\t1\tWrappedArray(500, 250, 100)\t1\tPh.D.\tEECS\tUC Berkeley\n2\tMichael Armbrust\t1\tWrappedArray(250, 100)\t1\tPh.D.\tEECS\tUC Berkeley\n"}]},"apps":[],"jobName":"paragraph_1625932247976_-1448997064","id":"20210710-155047_1988094523","dateCreated":"2021-07-10T15:50:47+0000","dateStarted":"2021-07-10T15:54:15+0000","dateFinished":"2021-07-10T15:54:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:6417"},{"title":"잘못된 Inner Join 표현","text":"%spark.pyspark\n\n# 모두에 키가 존재하지 않는 경우: 결과 DataFrame에서 볼 수 없다.\nwrongJoinExpression = person[\"name\"] == graduateProgram[\"school\"]\n","user":"anonymous","dateUpdated":"2021-07-10T15:57:58+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1538725461684_159352467","id":"20181005-074421_264081189","dateCreated":"2018-10-05T07:44:21+0000","dateStarted":"2021-07-10T15:57:58+0000","dateFinished":"2021-07-10T15:57:58+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:6418"},{"title":"잘못된 Inner Join 표현 - ver1 방법","text":"%spark.pyspark\ninner_join = person.join(graduateProgram, person.name == graduateProgram.school)\ninner_join.show()\n","user":"anonymous","dateUpdated":"2021-07-10T15:59:03+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+----+----------------+------------+---+------+----------+------+\n| id|name|graduate_program|spark_status| id|degree|department|school|\n+---+----+----------------+------------+---+------+----------+------+\n+---+----+----------------+------------+---+------+----------+------+\n\n"}]},"apps":[],"jobName":"paragraph_1625932683342_509378310","id":"20210710-155803_2136035967","dateCreated":"2021-07-10T15:58:03+0000","dateStarted":"2021-07-10T15:58:37+0000","dateFinished":"2021-07-10T15:58:39+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:6419"},{"title":"Outer Join (외부 조인) - 합집합","text":"%spark.pyspark\n\njoinType = \"outer\"\nperson.join(graduateProgram, joinExpression, joinType).show()","user":"anonymous","dateUpdated":"2021-07-10T16:29:19+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----+----------------+----------------+---------------+---+-------+--------------------+-----------+\n|  id|            name|graduate_program|   spark_status| id| degree|          department|     school|\n+----+----------------+----------------+---------------+---+-------+--------------------+-----------+\n|   0|   Bill Chambers|               0|          [100]|  0|Masters|School of Informa...|UC Berkeley|\n|   1|   Matei Zaharia|               1|[500, 250, 100]|  1|  Ph.D.|                EECS|UC Berkeley|\n|   2|Michael Armbrust|               1|     [250, 100]|  1|  Ph.D.|                EECS|UC Berkeley|\n|null|            null|            null|           null|  2|Masters|                EECS|UC Berkeley|\n+----+----------------+----------------+---------------+---+-------+--------------------+-----------+\n\n"}]},"apps":[],"jobName":"paragraph_1625934510072_-16413795","id":"20210710-162830_847863207","dateCreated":"2021-07-10T16:28:30+0000","dateStarted":"2021-07-10T16:28:59+0000","dateFinished":"2021-07-10T16:29:01+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:6420"},{"title":"Left Outer Join (왼쪽 외부 조인) - 왼쪽은 모두 show","text":"%spark.pyspark\n\njoinType = \"left_outer\"\nperson.join(graduateProgram, joinExpression, joinType).show()","user":"anonymous","dateUpdated":"2021-07-10T16:30:18+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+----------------+----------------+---------------+---+-------+--------------------+-----------+\n| id|            name|graduate_program|   spark_status| id| degree|          department|     school|\n+---+----------------+----------------+---------------+---+-------+--------------------+-----------+\n|  0|   Bill Chambers|               0|          [100]|  0|Masters|School of Informa...|UC Berkeley|\n|  1|   Matei Zaharia|               1|[500, 250, 100]|  1|  Ph.D.|                EECS|UC Berkeley|\n|  2|Michael Armbrust|               1|     [250, 100]|  1|  Ph.D.|                EECS|UC Berkeley|\n+---+----------------+----------------+---------------+---+-------+--------------------+-----------+\n\n"}]},"apps":[],"jobName":"paragraph_1538725461722_1160155153","id":"20181005-074421_357899352","dateCreated":"2018-10-05T07:44:21+0000","dateStarted":"2021-07-10T16:30:18+0000","dateFinished":"2021-07-10T16:30:20+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:6421"},{"title":"Right Outer Join (오른쪽 외부 조인) - 오른쪽은 모두 show","text":"%spark.pyspark\n\njoinType = \"right_outer\"\nperson.join(graduateProgram, joinExpression, joinType).show()","user":"anonymous","dateUpdated":"2021-07-10T16:30:49+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----+----------------+----------------+---------------+---+-------+--------------------+-----------+\n|  id|            name|graduate_program|   spark_status| id| degree|          department|     school|\n+----+----------------+----------------+---------------+---+-------+--------------------+-----------+\n|   0|   Bill Chambers|               0|          [100]|  0|Masters|School of Informa...|UC Berkeley|\n|   1|   Matei Zaharia|               1|[500, 250, 100]|  1|  Ph.D.|                EECS|UC Berkeley|\n|   2|Michael Armbrust|               1|     [250, 100]|  1|  Ph.D.|                EECS|UC Berkeley|\n|null|            null|            null|           null|  2|Masters|                EECS|UC Berkeley|\n+----+----------------+----------------+---------------+---+-------+--------------------+-----------+\n\n"}]},"apps":[],"jobName":"paragraph_1625934626658_1188514965","id":"20210710-163026_875354146","dateCreated":"2021-07-10T16:30:26+0000","dateStarted":"2021-07-10T16:30:35+0000","dateFinished":"2021-07-10T16:30:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:6422"},{"title":"Left Semi Join (왼쪽 세미 조인) - 오른쪽 테이블 값 없지만, 비교 용도로만 오른쪽 테이블 사용. 존재하면 왼쪽 테이블 결과 포함. ","text":"%spark.pyspark\n\njoinType = \"left_semi\"\nperson.join(graduateProgram, joinExpression, joinType).show()\n\njoinType = \"left_semi\"\ngraduateProgram.join(person, joinExpression, joinType).show()","user":"anonymous","dateUpdated":"2021-07-10T16:39:07+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+----------------+----------------+---------------+\n| id|            name|graduate_program|   spark_status|\n+---+----------------+----------------+---------------+\n|  0|   Bill Chambers|               0|          [100]|\n|  1|   Matei Zaharia|               1|[500, 250, 100]|\n|  2|Michael Armbrust|               1|     [250, 100]|\n+---+----------------+----------------+---------------+\n\n+---+-------+--------------------+-----------+\n| id| degree|          department|     school|\n+---+-------+--------------------+-----------+\n|  0|Masters|School of Informa...|UC Berkeley|\n|  1|  Ph.D.|                EECS|UC Berkeley|\n+---+-------+--------------------+-----------+\n\n"}]},"apps":[],"jobName":"paragraph_1625934669751_-977715746","id":"20210710-163109_55082539","dateCreated":"2021-07-10T16:31:09+0000","dateStarted":"2021-07-10T16:36:14+0000","dateFinished":"2021-07-10T16:36:16+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:6423"},{"title":"Q. 오른쪽 세미 조인이 존재하는가?","text":"%spark.pyspark\n\njoinType = \"right_semi\"\nperson.join(graduateProgram, joinExpression, joinType).show()","user":"anonymous","dateUpdated":"2021-07-10T16:32:38+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"Fail to execute line 2: person.join(graduateProgram, joinExpression, joinType).show()\nTraceback (most recent call last):\n  File \"/tmp/zeppelin_pyspark-1818252464357747704.py\", line 380, in <module>\n    exec(code, _zcUserQueryNameSpace)\n  File \"<stdin>\", line 2, in <module>\n  File \"/spark-2.3.2-bin-hadoop2.7/python/lib/pyspark.zip/pyspark/sql/dataframe.py\", line 931, in join\n    jdf = self._jdf.join(other._jdf, on, how)\n  File \"/spark-2.3.2-bin-hadoop2.7/python/lib/py4j-0.10.7-src.zip/py4j/java_gateway.py\", line 1257, in __call__\n    answer, self.gateway_client, self.target_id, self.name)\n  File \"/spark-2.3.2-bin-hadoop2.7/python/lib/pyspark.zip/pyspark/sql/utils.py\", line 79, in deco\n    raise IllegalArgumentException(s.split(': ', 1)[1], stackTrace)\nIllegalArgumentException: u\"Unsupported join type 'right_semi'. Supported join types include: 'inner', 'outer', 'full', 'fullouter', 'full_outer', 'leftouter', 'left', 'left_outer', 'rightouter', 'right', 'right_outer', 'leftsemi', 'left_semi', 'leftanti', 'left_anti', 'cross'.\"\n"}]},"apps":[],"jobName":"paragraph_1625934722141_-673721322","id":"20210710-163202_2115021697","dateCreated":"2021-07-10T16:32:02+0000","dateStarted":"2021-07-10T16:32:11+0000","dateFinished":"2021-07-10T16:32:11+0000","status":"ERROR","progressUpdateIntervalMs":500,"$$hashKey":"object:6424"},{"title":"Left Anti Join (왼쪽 안티 조인) - 오른쪽 테이블 값 없지만, 비교 용도로만 오른쪽 테이블 사용. 존재하지 않으면 왼쪽 테이블 결과 포함. (Semi 반대)","text":"%spark.pyspark\n\njoinType = \"left_anti\"\nperson.join(graduateProgram, joinExpression, joinType).show()\n\njoinType = \"left_anti\"\ngraduateProgram.join(person, joinExpression, joinType).show()","user":"anonymous","dateUpdated":"2021-07-10T16:40:02+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+----+----------------+------------+\n| id|name|graduate_program|spark_status|\n+---+----+----------------+------------+\n+---+----+----------------+------------+\n\n+---+-------+----------+-----------+\n| id| degree|department|     school|\n+---+-------+----------+-----------+\n|  2|Masters|      EECS|UC Berkeley|\n+---+-------+----------+-----------+\n\n"}]},"apps":[],"jobName":"paragraph_1625934769269_-203958603","id":"20210710-163249_858500262","dateCreated":"2021-07-10T16:32:49+0000","dateStarted":"2021-07-10T16:38:17+0000","dateFinished":"2021-07-10T16:38:19+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:6425"},{"title":"Natural Join (자연 조인) - 조인하려는 컬럼을 암시적으로 추정. 하지만 이는 부정확한 결과를 초래할 수 있으므로 조심해야 함.","text":"%sql\n\nselect * from graduateProgram NATURAL JOIN person","user":"anonymous","dateUpdated":"2021-07-10T16:41:17+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"id":"string","degree":"string","department":"string","school":"string","name":"string","graduate_program":"string","spark_status":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql","title":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"id\tdegree\tdepartment\tschool\tname\tgraduate_program\tspark_status\n0\tMasters\tSchool of Information\tUC Berkeley\tBill Chambers\t0\tWrappedArray(100)\n1\tPh.D.\tEECS\tUC Berkeley\tMatei Zaharia\t1\tWrappedArray(500, 250, 100)\n2\tMasters\tEECS\tUC Berkeley\tMichael Armbrust\t1\tWrappedArray(250, 100)\n"}]},"apps":[],"jobName":"paragraph_1625935206747_1079958992","id":"20210710-164006_1214689069","dateCreated":"2021-07-10T16:40:06+0000","dateStarted":"2021-07-10T16:41:15+0000","dateFinished":"2021-07-10T16:41:16+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:6426"},{"title":"Cross Join (교차 조인) - 왼쪽의 모든 raw를 오른쪽의 모든 raw와 결합. 키워드 없이 조인을 하면 개수가 많아지므로, 키워드 명시 필요. (키워드 지정 안한 경우)%spark.pyspark","text":"%sql\nselect * from graduateProgram CROSS JOIN person","user":"anonymous","dateUpdated":"2021-07-10T16:46:30+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"id":"string","degree":"string","department":"string","school":"string","name":"string","graduate_program":"string","spark_status":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql","title":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"id\tdegree\tdepartment\tschool\tid\tname\tgraduate_program\tspark_status\n0\tMasters\tSchool of Information\tUC Berkeley\t0\tBill Chambers\t0\tWrappedArray(100)\n0\tMasters\tSchool of Information\tUC Berkeley\t1\tMatei Zaharia\t1\tWrappedArray(500, 250, 100)\n0\tMasters\tSchool of Information\tUC Berkeley\t2\tMichael Armbrust\t1\tWrappedArray(250, 100)\n2\tMasters\tEECS\tUC Berkeley\t0\tBill Chambers\t0\tWrappedArray(100)\n2\tMasters\tEECS\tUC Berkeley\t1\tMatei Zaharia\t1\tWrappedArray(500, 250, 100)\n2\tMasters\tEECS\tUC Berkeley\t2\tMichael Armbrust\t1\tWrappedArray(250, 100)\n1\tPh.D.\tEECS\tUC Berkeley\t0\tBill Chambers\t0\tWrappedArray(100)\n1\tPh.D.\tEECS\tUC Berkeley\t1\tMatei Zaharia\t1\tWrappedArray(500, 250, 100)\n1\tPh.D.\tEECS\tUC Berkeley\t2\tMichael Armbrust\t1\tWrappedArray(250, 100)\n"}]},"apps":[],"jobName":"paragraph_1625935290211_-701399265","id":"20210710-164130_1625965123","dateCreated":"2021-07-10T16:41:30+0000","dateStarted":"2021-07-10T16:45:31+0000","dateFinished":"2021-07-10T16:45:32+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:6427"},{"title":"Cross Join (교차 조인) - 왼쪽의 모든 raw를 오른쪽의 모든 raw와 결합. 키워드 없이 조인을 하면 개수가 많아지므로, 키워드 명시 필요. (키워드 지정 안한 경우)","text":"%spark.pyspark\n\nperson.crossJoin(graduateProgram).show()","user":"anonymous","dateUpdated":"2021-07-10T16:46:54+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"id":"string","degree":"string","department":"string","school":"string","name":"string","graduate_program":"string","spark_status":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+----------------+----------------+---------------+---+-------+--------------------+-----------+\n| id|            name|graduate_program|   spark_status| id| degree|          department|     school|\n+---+----------------+----------------+---------------+---+-------+--------------------+-----------+\n|  0|   Bill Chambers|               0|          [100]|  0|Masters|School of Informa...|UC Berkeley|\n|  0|   Bill Chambers|               0|          [100]|  2|Masters|                EECS|UC Berkeley|\n|  0|   Bill Chambers|               0|          [100]|  1|  Ph.D.|                EECS|UC Berkeley|\n|  1|   Matei Zaharia|               1|[500, 250, 100]|  0|Masters|School of Informa...|UC Berkeley|\n|  1|   Matei Zaharia|               1|[500, 250, 100]|  2|Masters|                EECS|UC Berkeley|\n|  1|   Matei Zaharia|               1|[500, 250, 100]|  1|  Ph.D.|                EECS|UC Berkeley|\n|  2|Michael Armbrust|               1|     [250, 100]|  0|Masters|School of Informa...|UC Berkeley|\n|  2|Michael Armbrust|               1|     [250, 100]|  2|Masters|                EECS|UC Berkeley|\n|  2|Michael Armbrust|               1|     [250, 100]|  1|  Ph.D.|                EECS|UC Berkeley|\n+---+----------------+----------------+---------------+---+-------+--------------------+-----------+\n\n"}]},"apps":[],"jobName":"paragraph_1625935567553_1321984303","id":"20210710-164607_360628540","dateCreated":"2021-07-10T16:46:07+0000","dateStarted":"2021-07-10T16:46:54+0000","dateFinished":"2021-07-10T16:46:55+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:6428"},{"title":"Cross Join (교차 조인) - 왼쪽의 모든 raw를 오른쪽의 모든 raw와 결합. 키워드 없이 조인을 하면 개수가 많아지므로, 키워드 명시 필요. (키워드 지정한 경우)","text":"%sql\n\nselect * from graduateProgram CROSS JOIN person\non graduateProgram.id = person.graduate_program","user":"anonymous","dateUpdated":"2021-07-10T16:45:22+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"id":"string","degree":"string","department":"string","school":"string","name":"string","graduate_program":"string","spark_status":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql","title":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"id\tdegree\tdepartment\tschool\tid\tname\tgraduate_program\tspark_status\n0\tMasters\tSchool of Information\tUC Berkeley\t0\tBill Chambers\t0\tWrappedArray(100)\n1\tPh.D.\tEECS\tUC Berkeley\t1\tMatei Zaharia\t1\tWrappedArray(500, 250, 100)\n1\tPh.D.\tEECS\tUC Berkeley\t2\tMichael Armbrust\t1\tWrappedArray(250, 100)\n"}]},"apps":[],"jobName":"paragraph_1625935469914_-1750444775","id":"20210710-164429_1499663345","dateCreated":"2021-07-10T16:44:29+0000","dateStarted":"2021-07-10T16:45:22+0000","dateFinished":"2021-07-10T16:45:23+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:6429"},{"title":"Join 이슈: 복합 데이터 타입의 조인","text":"%spark.pyspark\n\nfrom pyspark.sql.functions import expr\n\nperson.withColumnRenamed(\"id\",\"personID\").join(sparkStatus, expr(\"array_contains(spark_status, id)\")).show()\n","user":"anonymous","dateUpdated":"2021-07-10T16:59:06+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------+----------------+----------------+---------------+---+--------------+\n|personID|            name|graduate_program|   spark_status| id|        status|\n+--------+----------------+----------------+---------------+---+--------------+\n|       0|   Bill Chambers|               0|          [100]|100|   Contributor|\n|       1|   Matei Zaharia|               1|[500, 250, 100]|500|Vice President|\n|       1|   Matei Zaharia|               1|[500, 250, 100]|250|    PMC Member|\n|       1|   Matei Zaharia|               1|[500, 250, 100]|100|   Contributor|\n|       2|Michael Armbrust|               1|     [250, 100]|250|    PMC Member|\n|       2|Michael Armbrust|               1|     [250, 100]|100|   Contributor|\n+--------+----------------+----------------+---------------+---+--------------+\n\n"}]},"apps":[],"jobName":"paragraph_1625936127136_207592839","id":"20210710-165527_2135511805","dateCreated":"2021-07-10T16:55:27+0000","dateStarted":"2021-07-10T16:59:06+0000","dateFinished":"2021-07-10T16:59:07+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:6430"},{"title":"Join 이슈: 중복 컬럼명 처리","text":"%spark.pyspark\n\n# 위와 똑같지만 같은 column name이 있다는 이유로 에러가 납니다.\nperson.join(sparkStatus, expr(\"array_contains(spark_status, id)\")).show()\n\n","user":"anonymous","dateUpdated":"2021-07-10T17:00:51+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"Fail to execute line 2: person.join(sparkStatus, expr(\"array_contains(spark_status, id)\")).show()\nTraceback (most recent call last):\n  File \"/tmp/zeppelin_pyspark-1818252464357747704.py\", line 380, in <module>\n    exec(code, _zcUserQueryNameSpace)\n  File \"<stdin>\", line 2, in <module>\n  File \"/spark-2.3.2-bin-hadoop2.7/python/lib/pyspark.zip/pyspark/sql/dataframe.py\", line 931, in join\n    jdf = self._jdf.join(other._jdf, on, how)\n  File \"/spark-2.3.2-bin-hadoop2.7/python/lib/py4j-0.10.7-src.zip/py4j/java_gateway.py\", line 1257, in __call__\n    answer, self.gateway_client, self.target_id, self.name)\n  File \"/spark-2.3.2-bin-hadoop2.7/python/lib/pyspark.zip/pyspark/sql/utils.py\", line 69, in deco\n    raise AnalysisException(s.split(': ', 1)[1], stackTrace)\nAnalysisException: u\"Reference 'id' is ambiguous, could be: id, id.; line 1 pos 29\"\n"}]},"apps":[],"jobName":"paragraph_1538725461745_-734652089","id":"20181005-074421_1374078984","dateCreated":"2018-10-05T07:44:21+0000","dateStarted":"2021-07-10T17:00:26+0000","dateFinished":"2021-07-10T17:00:26+0000","status":"ERROR","progressUpdateIntervalMs":500,"$$hashKey":"object:6431"},{"title":"Join 이슈: 중복 컬럼명 처리 해결방법: Join 전 Rename - 완전한 회피 가능","text":"%spark.pyspark\n\nfrom pyspark.sql.functions import expr\n\nperson.withColumnRenamed(\"id\",\"personID\").join(sparkStatus, expr(\"array_contains(spark_status, id)\")).show()\n","user":"anonymous","dateUpdated":"2021-07-10T17:02:01+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------+----------------+----------------+---------------+---+--------------+\n|personID|            name|graduate_program|   spark_status| id|        status|\n+--------+----------------+----------------+---------------+---+--------------+\n|       0|   Bill Chambers|               0|          [100]|100|   Contributor|\n|       1|   Matei Zaharia|               1|[500, 250, 100]|500|Vice President|\n|       1|   Matei Zaharia|               1|[500, 250, 100]|250|    PMC Member|\n|       1|   Matei Zaharia|               1|[500, 250, 100]|100|   Contributor|\n|       2|Michael Armbrust|               1|     [250, 100]|250|    PMC Member|\n|       2|Michael Armbrust|               1|     [250, 100]|100|   Contributor|\n+--------+----------------+----------------+---------------+---+--------------+\n\n"}]},"apps":[],"jobName":"paragraph_1625936440859_2137301578","id":"20210710-170040_1560671718","dateCreated":"2021-07-10T17:00:40+0000","dateStarted":"2021-07-10T17:02:01+0000","dateFinished":"2021-07-10T17:02:02+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:6432"}],"name":"Spark-The-Definitive-Guide-Python/Structured_APIs-Chapter_8_Joins.py","id":"2DRGNTGGT","noteParams":{},"noteForms":{},"angularObjects":{"sh:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}